import json, requests
from flask_pymongo import PyMongo
from activipy import vocab

from .forms import userLogin, userRegister, composePost
from .users import User

# from .emails import lostPassword, checkToken
mongo = PyMongo(app)

SERVER_URL = 'http://populator.smilodon.social/'
API_HEADERS = {'Content-Type': 'application/ld+json', 'profile': 'https://www.w3.org/ns/activitystreams'}

@lm.user_loader
def load_user(handle):
    u = mongo.db.users.find_one({"id": handle})
    if not u:
        return None
    return User(u['id'])

@app.route('/', methods=['GET', 'POST'])
@login_required
def index():
	user = mongo.db.users.find_one({'id': current_user.get_id()})
	r = requests.get('http://localhost:5000/api/roo/inbox', headers=API_HEADERS)
